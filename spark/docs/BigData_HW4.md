# ДОМАШНЕЕ ЗАДАНИЕ 4. Рекомендательные системы и Spark MLlib

### Содержание

- [Задание 1. Анализ датасета](#Задание-1.-Анализ-датасета)
- [Задание 2. Коллаборативная фильтрация](#Задание-2.-Коллаборативная-фильтрация)
- [Задание 3. Факторизация матрицы](#Задание-3.-Факторизация-матрицы)

Чтобы узнать свой вариант, запустите `python` код с указанием Вашей фамилии:

```python
surname = "Иванов" #Ваша фамилия

alp = 'абвгдеёжзийклмнопрстуфхцчшщъыьэюя'
w = [1, 42, 21, 21, 34,  6, 44, 26, 18, 44, 38, 26, 14, 43,  4, 49, 45,
        7, 42, 29,  4,  9, 36, 34, 31, 29,  5, 30,  4, 19, 28, 25, 33]

d = dict(zip(alp, w))
variant =  sum([d[el] for el in surname.lower()]) % 40 + 1

print("Задача № 1: ", variant % 3 + 1)
print("Задача № 2: ", variant % 2 + 1 )
```

Набор данных:

- [Небольшой набор данных](http://files.grouplens.org/datasets/movielens/ml-latest-small.zip)
- [Полный набор данных](http://files.grouplens.org/datasets/movielens/ml-latest.zip)

⚠️ **Замечания**:
1. Сначала выполните указанные ниже задачи для небольшого набора данных, потом для полного
2. Использовать `Dataframe API`. Исключением может быть задача 2


## **Задание 1**. Анализ датасета

- **Вариант 1.** Animation, Romance, Documentary
- **Вариант 2.** Drama, Comedy, Musical
- **Вариант 3.** Thriller, Sci-Fi, Adventure

⚠️ **Замечание:** Один фильм может принадлежать разным жанрам

1. Выведите данные, сопоставляющие жанры и количество фильмов
2. Выведите первые 10 фильмов с наибольшим количеством рейтингов для каждого жанра в соответствии с вариантом
3. Выведите первые 10 фильмов с наименьшим количеством рейтингов (но больше 10) для каждого жанра в соответствии с вариантом
4. Выведите первые 10 фильмов с наибольшим средним рейтингом при количестве рейтингов больше 10 для каждого жанра в соответствии с вариантом
5. Выведите первые 10 фильмов с наименьшим средним рейтингом при количестве рейтингов больше 10 для каждого жанра в соответствии с вариантом


## **Задание 2**. Коллаборативная фильтрация

- **Вариант 1.** По схожести пользователей
- **Вариант 2.** По схожести объектов

1. Разделите данные с рейтингами на обучающее (train_init - 0.8) и тестовое подмножества (test - 0.2), определите среднее значение рейтинга в обучающем подмножестве и вычислите `rmse` для тестового подмножества, если для всех значений из test предсказывается среднее значение рейтинга
2. Реализуйте коллаборативную фильтрацию в соответствии с вариантом. Для определения схожести используйте train_init, для расчета `rmse` - test
3. Определите `rmse` для тестового подмножества

## **Задание 3**. Факторизация матрицы

1. Выберите модель `ALS` по минимальному значению `rmse`. Для этого используйте кросс-валидацию `k-folds` c k=4

    Параметры:
    - Количество факторов: `[5, 10, 15]`
    - Регуляризация: `[0.001, 0.01, 0.1, 1, 10]`

    ⚠️ **Замечание:** Если какие-то элементы из тестового/валидационного подмножества не встречались в обучающем, то `rmse` будет `NaN`

2. Сравните результаты рекомендаций посредством коллаборативной фильтрации и факторизации матрицы рейтингов
